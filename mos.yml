author: mongoose-os
description: DHT sensor usage example (JavaScript)
version: 1.0

libs_version: ${mos.version}
modules_version: ${mos.version}
mongoose_os_version: ${mos.version}

sources:
  - src
filesystem:
  - fs

conds:
  - when: mos.platform == "esp32"
    apply:
      config_schema:
        - ["devices.mainHeater.HEAT_PIN", "i", 22, {title: "My app custom settings"}]
        - ["devices.mainHeater.POWER_PIN", "i", 23, {title: "My app custom settings"}]
        - ["devices.mainDHT.DHT_PIN", "i", 4, {title: "My app custom settings"}]
        - ["pins.DEC_BUTTON", "i", 18, {title: "GPIO pin ..."}]
        - ["pins.INC_BUTTON", "i", 19, {title: "GPIO pin ..."}]
        - ["pins.SWITCH_BUTTON", "i", 21, {title: "GPIO pin ..."}]

config_schema:
  - ["i2c.enable", true]
  - ["mqtt.server", "iot.eclipse.org:1883"]
  - ["file_logger.enable", true]
  - ["file_logger.max_num_files", 4]
  - ["dash.enable", true]
  - ["dash.token", "62e00e6e2915c9b80f80f6e212e748a8"]
  # - ["mqtt.enable", true]
  # - ["rpc.mqtt.enable", true]
  # - ["rpc.mqtt.topic", "qweyuiasdhjky/p/smart_heater/asdqwezxc/mc/rpc"]
  # - ["wifi.sta.enable", true]
  - ["device.id", "qwertyqwerty"]
  - ["device.type", "s", "smart_heater", {title: "JSON with modules"}]

  - ["server", "o", {title: "My app custom settings"}]
  - ["server.id", "s", "qweyuiasdhjky", {title: "My app custom settings"}]
  - ["server.topicName", "s", "qweyuiasdhjky/qwertyqwerty/s/rpc", {title: "My app custom settings"}]

  - ["devices", "o", {title: "My app custom settings"}]

  - ["devices.mainDevice", "o", {title: "My app custom settings"}]
  - ["devices.mainDevice.id", "s", "qwertyqwerty", {title: "JSON with modules"}]
  - ["devices.mainDevice.type", "s", "smart_heater", {title: "JSON with modules"}]

  - ["devices.mainHeater", "o", {title: "My app custom settings"}]
  - ["devices.mainHeater.id", "s", "asdqwezxc", {title: "JSON with modules"}]
  - ["devices.mainHeater.HEAT_PIN", "i", 13, {title: "My app custom settings"}]
  - ["devices.mainHeater.POWER_PIN", "i", 16, {title: "My app custom settings"}]
  - ["devices.mainHeater.turnedOn", "b", true, {title: "My app custom settings"}]

  - ["devices.mainDHT", "o", {title: "My app custom settings"}]
  - ["devices.mainDHT.id", "s", "qweiopasd", {title: "JSON with modules"}]
  - ["devices.mainDHT.DHT_PIN", "i", 0, {title: "My app custom settings"}]
  - ["devices.mainDHT.minTemp", "i", 10, {title: "My app custom settings"}]
  - ["devices.mainDHT.maxTemp", "i", 20, {title: "My app custom settings"}]
  - ["devices.mainDHT.autoCtrl", "b", true, {title: "My app custom settings"}]
  - ["devices.mainDHT.minTempActions", "s", "[{\"method\":\"asdqwezxc.SetState\",\"args\":{\"heatActive\":true},\"local\":true,\"interval\":60}]", {title: "JSON with modules"}]
  - ["devices.mainDHT.maxTempActions", "s", "[{\"method\":\"asdqwezxc.SetState\",\"args\":{\"heatActive\":false},\"local\":true,\"interval\":60}]", {title: "JSON with modules"}]
  # - ["devices.mainDHT.maxTempActions", "s", "[{\"method\":\"qwertyqwerty.Shadow.Delta\",\"args\":{\"state\": {"mainHeaterState":{"heatActive": false}},\"local\":true,\"interval\":60}]", {title: "JSON with modules"}]
  - ["devices.mainDHT.mainTimerInterval", "i", 10000, {title: "My app custom settings"}]

  - ["pins", "o", {title: "My app custom settings"}]
  - ["pins.DEC_BUTTON", "i", 5, {title: "GPIO pin ..."}]
  - ["pins.INC_BUTTON", "i", 4, {title: "GPIO pin ..."}]
  - ["pins.SWITCH_BUTTON", "i", 2, {title: "GPIO pin ..."}]

libs:
    # common mgos libs
  - origin: https://github.com/mongoose-os-libs/ca-bundle
  - origin: https://github.com/mongoose-os-libs/i2c
  - origin: https://github.com/mongoose-os-libs/http-server
  - origin: https://github.com/mongoose-os-libs/rpc-uart
  # - origin: https://github.com/mongoose-os-libs/bt-service-config
  # - origin: https://github.com/mongoose-os-libs/bt-service-debug
  - origin: https://github.com/mongoose-os-libs/ota-http-client
  - origin: https://github.com/mongoose-os-libs/ota-http-server
  # - origin: https://github.com/mongoose-os-libs/mqtt
  - origin: https://github.com/mongoose-os-libs/wifi
  - origin: https://github.com/mongoose-os-libs/rpc-mqtt
  - origin: https://github.com/mongoose-os-libs/rpc-loopback
  - origin: https://github.com/mongoose-os-libs/rpc-service-config
  - origin: https://github.com/mongoose-os-libs/rpc-service-fs
  - origin: https://github.com/mongoose-os-libs/rpc-service-gpio
  # - origin: https://github.com/mongoose-os-libs/rpc-service-i2c
  - origin: https://github.com/mongoose-os-libs/rpc-service-ota
  - origin: https://github.com/mongoose-os-libs/rpc-service-wifi
  - origin: https://github.com/mongoose-os-libs/mjs
  - origin: https://github.com/mongoose-os-libs/dash
  - origin: https://github.com/mongoose-os-libs/file-logger

    # libs necessary for the current app
  - origin: https://github.com/mongoose-os-libs/dht
  - origin: https://github.com/Dionid/arduino-LiquidCrystal_I2C

tags:
  - js
  - hw

manifest_version: 2017-05-18
